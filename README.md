# Claude Code è‡ªåŠ¨å®¡æ‰¹è„šæœ¬é›†åˆ

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ Claude Code è‡ªåŠ¨å®¡æ‰¹è„šæœ¬é›†åˆï¼ŒåŒ…å«å¤šç§å®¡æ‰¹ç­–ç•¥å’Œå·¥å…·ï¼Œæ”¯æŒ Linux å’Œ Windows ç¯å¢ƒã€‚

**ä¸­æ–‡ç‰ˆæœ¬** | [English Version](README_en.md)

## ğŸ“ ç›®å½•ç»“æ„

```
claude-auto-approval-scripts/
â”œâ”€â”€ basic/                          # åŸºç¡€å®¡æ‰¹è„šæœ¬
â”‚   â”œâ”€â”€ auto-approve-basic.sh       # åŸºç¡€å®‰å…¨å®¡æ‰¹ï¼ˆLinuxï¼‰
â”œâ”€â”€ smart/                          # æ™ºèƒ½ä¸Šä¸‹æ–‡æ„ŸçŸ¥è„šæœ¬
â”‚   â””â”€â”€ smart-context-approve.sh    # æ™ºèƒ½ä¸Šä¸‹æ–‡å®¡æ‰¹ï¼ˆLinuxï¼‰
â”œâ”€â”€ tiered/                         # åˆ†å±‚å®¡æ‰¹ç­–ç•¥
â”‚   â””â”€â”€ tiered-approval.sh          # åŸºäºé£é™©è¯„åˆ†çš„åˆ†å±‚å®¡æ‰¹
â”œâ”€â”€ environment-specific/           # ç¯å¢ƒç‰¹å®šé…ç½®
â”‚   â”œâ”€â”€ dev-environment-approve.sh  # å¼€å‘ç¯å¢ƒå®¡æ‰¹
â”‚   â”œâ”€â”€ prod-environment-approve.sh # ç”Ÿäº§ç¯å¢ƒå®¡æ‰¹
â”‚   â””â”€â”€ cicd-environment-approve.sh # CI/CDç¯å¢ƒå®¡æ‰¹
â”œâ”€â”€ advanced/                       # é«˜çº§åŠŸèƒ½è„šæœ¬
â”‚   â”œâ”€â”€ time-window-approve.sh      # æ—¶é—´çª—å£å®¡æ‰¹
â”‚   â”œâ”€â”€ user-identity-approve.sh    # ç”¨æˆ·èº«ä»½æ„ŸçŸ¥å®¡æ‰¹
â”‚   â””â”€â”€ combined-intelligent-approve.sh # ç»„åˆæ™ºèƒ½å®¡æ‰¹
â”œâ”€â”€ testing/                        # æµ‹è¯•å’Œè°ƒè¯•å·¥å…·
â”‚   â”œâ”€â”€ test-approval-scripts.sh    # è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·
â”‚   â””â”€â”€ debug-approval-script.sh    # è°ƒè¯•å·¥å…·
â””â”€â”€ windows-versions/               # Windowsç‰ˆæœ¬è„šæœ¬
    â”œâ”€â”€ auto-approve-basic.bat      # åŸºç¡€å®¡æ‰¹ï¼ˆWindowsï¼‰
    â””â”€â”€ smart-context-approve.bat   # æ™ºèƒ½å®¡æ‰¹ï¼ˆWindowsï¼‰
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ğŸ†• ç»Ÿä¸€è®¾ç½®å·¥å…·ï¼ˆå¼ºçƒˆæ¨èï¼‰

ä½¿ç”¨å…¨æ–°çš„ç»Ÿä¸€è®¾ç½®å·¥å…·ï¼Œä¸€é”®å®Œæˆæ‰€æœ‰é…ç½®ï¼š

```bash
# äº¤äº’å¼è®¾ç½®ï¼ˆæ¨èæ–°æ‰‹ä½¿ç”¨ï¼‰
./setup-v2.sh

# å¿«é€Ÿéƒ¨ç½²ç”¨æˆ·çº§æ™ºèƒ½å®¡æ‰¹ï¼ˆæ¨èä¸ªäººä½¿ç”¨ï¼‰
./setup-v2.sh -q -e smart -m user

# é¡¹ç›®çº§å¼€å‘ç¯å¢ƒï¼ˆæ¨èæ–°é¡¹ç›®ï¼‰
./setup-v2.sh -e dev -m project -p ~/my-project

# å…¨å±€è‡ªåŠ¨æ£€æµ‹æ¨¡å¼ï¼ˆæ¨èæœåŠ¡å™¨ï¼‰
./setup-v2.sh -e auto -m global
```

### ğŸ“‹ è®¾ç½®å·¥å…·åŠŸèƒ½

**setup-v2.sh æä¾›ï¼š**
- ğŸ§  **æ™ºèƒ½é¡¹ç›®æ£€æµ‹** - è‡ªåŠ¨è¯†åˆ«é¡¹ç›®ç±»å‹ï¼ˆNode.jsã€Pythonã€Javaç­‰ï¼‰
- ğŸ¯ **ç¯å¢ƒæ¨è** - æ ¹æ®é¡¹ç›®ç±»å‹æ™ºèƒ½æ¨èåˆé€‚çš„å®¡æ‰¹ç­–ç•¥
- ğŸ”§ **å¤šç§å®‰è£…æ–¹å¼** - æ”¯æŒå…¨å±€ã€ç”¨æˆ·çº§ã€é¡¹ç›®çº§å®‰è£…
- âš¡ **å¿«é€Ÿæ¨¡å¼** - å‘½ä»¤è¡Œä¸€é”®éƒ¨ç½²
- ğŸ“Š **çŠ¶æ€ç®¡ç†** - éšæ—¶æŸ¥çœ‹å½“å‰é…ç½®çŠ¶æ€

**ğŸ“– è¯¦ç»†æŒ‡å—**: [æ–°è®¾ç½®å·¥å…·å®Œæ•´æŒ‡å—](NEW-SETUP-GUIDE.md)

### 2. ä¼ ç»Ÿæ‰‹åŠ¨é…ç½®ï¼ˆå¤‡é€‰ï¼‰

å¦‚æœéœ€è¦æ‰‹åŠ¨é…ç½®ï¼Œé€‰æ‹©é€‚åˆä½ éœ€æ±‚çš„å®¡æ‰¹è„šæœ¬ï¼Œç„¶ååœ¨ Claude Code çš„é…ç½®æ–‡ä»¶ä¸­å¼•ç”¨ï¼š

```json
{
  "PreToolUse": [
    {
      "matcher": "Write|Edit|Bash",
      "hooks": [
        {
          "type": "command",
          "command": "bash /path/to/claude-auto-approval-scripts/basic/auto-approve-basic.sh"
        }
      ]
    }
  ]
}
```

### 2. æ ¹æ®ç¯å¢ƒé€‰æ‹©è„šæœ¬

- **å¼€å‘ç¯å¢ƒ**: ä½¿ç”¨ `dev-environment-approve.sh`
- **ç”Ÿäº§ç¯å¢ƒ**: ä½¿ç”¨ `prod-environment-approve.sh`
- **CI/CDç¯å¢ƒ**: ä½¿ç”¨ `cicd-environment-approve.sh`
- **é€šç”¨åœºæ™¯**: ä½¿ç”¨ `combined-intelligent-approve.sh`

### 3. Windowsç”¨æˆ·

Windowsç”¨æˆ·è¯·ä½¿ç”¨ `windows-versions/` ç›®å½•ä¸‹çš„ `.bat` è„šæœ¬ã€‚

## ğŸ“‹ è„šæœ¬åŠŸèƒ½è¯´æ˜

### åŸºç¡€è„šæœ¬ (basic/)

- **auto-approve-basic.sh**: æä¾›åŸºç¡€çš„å®‰å…¨å®¡æ‰¹åŠŸèƒ½
  - è‡ªåŠ¨æ‰¹å‡†å®‰å…¨çš„åªè¯»æ“ä½œ
  - åŸºäºæ–‡ä»¶è·¯å¾„çš„æ™ºèƒ½å®¡æ‰¹
  - å±é™©å‘½ä»¤æ£€æµ‹å’Œæ‹’ç»

### æ™ºèƒ½è„šæœ¬ (smart/)

- **smart-context-approve.sh**: åŸºäºä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æ™ºèƒ½å®¡æ‰¹
  - é¡¹ç›®ç±»å‹è¯†åˆ«ï¼ˆNode.jsã€Pythonã€Javaç­‰ï¼‰
  - GitçŠ¶æ€æ„ŸçŸ¥
  - æ–‡ä»¶ç±»å‹æ™ºèƒ½åˆ¤æ–­

### åˆ†å±‚å®¡æ‰¹ (tiered/)

- **tiered-approval.sh**: åŸºäºé£é™©è¯„åˆ†çš„åˆ†å±‚å®¡æ‰¹
  - å¤šç»´åº¦é£é™©è¯„ä¼°
  - ä½/ä¸­/é«˜ä¸‰çº§é£é™©åˆ†ç±»
  - ç‰¹æ®Šè§„åˆ™è¦†ç›–æœºåˆ¶

### ç¯å¢ƒç‰¹å®š (environment-specific/)

- **dev-environment-approve.sh**: å¼€å‘ç¯å¢ƒä¸“ç”¨
  - ç›¸å¯¹å®½æ¾çš„å®¡æ‰¹ç­–ç•¥
  - æ”¯æŒå¼€å‘å·¥å…·å’Œå‘½ä»¤
  - å…è®¸ä¸´æ—¶æ–‡ä»¶æ“ä½œ

- **prod-environment-approve.sh**: ç”Ÿäº§ç¯å¢ƒä¸“ç”¨
  - æå…¶ä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶
  - åªå…è®¸æœ€å®‰å…¨çš„æ“ä½œ
  - è¯¦ç»†çš„å®¡è®¡æ—¥å¿—

- **cicd-environment-approve.sh**: CI/CDç¯å¢ƒä¸“ç”¨
  - è‡ªåŠ¨åŒ–ä¼˜å…ˆ
  - åŸºç¡€å®‰å…¨æ£€æŸ¥
  - æ€§èƒ½ä¼˜åŒ–

### é«˜çº§åŠŸèƒ½ (advanced/)

- **time-window-approve.sh**: æ—¶é—´çª—å£å®¡æ‰¹
  - å·¥ä½œæ—¶é—´/éå·¥ä½œæ—¶é—´ç­–ç•¥
  - å‘¨æœ«/èŠ‚å‡æ—¥ç‰¹æ®Šå¤„ç†
  - ç»´æŠ¤æ—¶é—´çª—å£

- **user-identity-approve.sh**: ç”¨æˆ·èº«ä»½æ„ŸçŸ¥
  - åŸºäºç”¨æˆ·æƒé™çš„å®¡æ‰¹
  - ç”¨æˆ·ç»„è¯†åˆ«
  - é¡¹ç›®æ‰€æœ‰æƒæ£€æŸ¥

- **combined-intelligent-approve.sh**: ç»„åˆæ™ºèƒ½å®¡æ‰¹
  - å¤šå› ç´ ç»¼åˆè¯„åˆ†
  - æœºå™¨å­¦ä¹ é›†æˆæ¥å£
  - ä¸Šä¸‹æ–‡å¢å¼ºå†³ç­–

## ğŸ§ª æµ‹è¯•å·¥å…·

### è‡ªåŠ¨åŒ–æµ‹è¯•

```bash
cd testing/
./test-approval-scripts.sh
```

åŠŸèƒ½ï¼š
- è‡ªåŠ¨åŒ–åŠŸèƒ½æµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•
- è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Š

### è°ƒè¯•å·¥å…·

```bash
cd testing/
./debug-approval-script.sh -d 3 -s -v ../basic/auto-approve-basic.sh '{"tool_name": "ls", "tool_input": {"path": "/tmp"}}'
```

åŠŸèƒ½ï¼š
- é€æ­¥æ‰§è¡Œè°ƒè¯•
- å˜é‡å€¼æ˜¾ç¤º
- æ€§èƒ½åˆ†æ
- è¾“å‡ºéªŒè¯

## âš™ï¸ é…ç½®é€‰é¡¹

### åŸºç¡€é…ç½®

åˆ›å»º `.claude/settings.json`ï¼š

```json
{
  "PreToolUse": [
    {
      "matcher": "Write|Edit",
      "hooks": [
        {
          "type": "command",
          "command": "bash ${CLAUDE_PLUGIN_ROOT}/scripts/auto-approve.sh"
        }
      ]
    }
  ]
}
```

### é«˜çº§é…ç½®

åˆ›å»ºé¡¹ç›®ç‰¹å®šçš„é…ç½®æ–‡ä»¶ï¼š

```json
// .claude-intelligent-config.json
{
  "approval_thresholds": {
    "high_trust": 80,
    "medium_trust": 60,
    "low_trust": 40
  },
  "time_restrictions": {
    "business_hours": {"start": 9, "end": 18},
    "weekend_mode": "strict"
  },
  "user_permissions": {
    "admin_users": ["john", "jane"],
    "developer_groups": ["engineering", "dev"]
  }
}
```

## ğŸ”§ è‡ªå®šä¹‰å¼€å‘

### åˆ›å»ºè‡ªå®šä¹‰å®¡æ‰¹è„šæœ¬

1. åŸºäºæ¨¡æ¿åˆ›å»ºæ–°è„šæœ¬
2. å®ç°å®¡æ‰¹é€»è¾‘
3. æ·»åŠ æµ‹è¯•ç”¨ä¾‹
4. é›†æˆåˆ°é…ç½®æ–‡ä»¶

### è„šæœ¬æ¨¡æ¿

```bash
#!/bin/bash
# è‡ªå®šä¹‰å®¡æ‰¹è„šæœ¬æ¨¡æ¿

input=$(cat)
tool_name=$(echo "$input" | jq -r '.tool_name')
tool_input=$(echo "$input" | jq -r '.tool_input')
project_root=$(echo "$input" | jq -r '.context.project_root')

# ä½ çš„å®¡æ‰¹é€»è¾‘
if [[ "$tool_name" == "YourCondition" ]]; then
    echo '{"decision": "approve"}'
else
    echo '{"continue": true}'
fi
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### æ€§èƒ½åŸºå‡†

- åŸºç¡€è„šæœ¬: ~0.01-0.05s
- æ™ºèƒ½è„šæœ¬: ~0.05-0.1s
- å¤æ‚ç»„åˆè„šæœ¬: ~0.1-0.3s

### ä¼˜åŒ–å»ºè®®

1. **å‡å°‘å¤–éƒ¨å‘½ä»¤è°ƒç”¨**
2. **ä½¿ç”¨ç¼“å­˜æœºåˆ¶**
3. **ç®€åŒ–æ¡ä»¶åˆ¤æ–­**
4. **é¿å…é‡å¤è®¡ç®—**

## ğŸ›¡ï¸ å®‰å…¨è€ƒè™‘

### å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] å±é™©å‘½ä»¤è¿‡æ»¤
- [ ] ç³»ç»Ÿç›®å½•ä¿æŠ¤
- [ ] æƒé™æå‡æ£€æµ‹
- [ ] ç½‘ç»œæ“ä½œå®‰å…¨
- [ ] èµ„æºè€—å°½é˜²æŠ¤

### æœ€ä½³å®è·µ

1. **æœ€å°æƒé™åŸåˆ™**
2. **åˆ†å±‚å®‰å…¨æ§åˆ¶**
3. **è¯¦ç»†å®¡è®¡æ—¥å¿—**
4. **å®šæœŸå®‰å…¨å®¡æŸ¥**

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è„šæœ¬æ— æ‰§è¡Œæƒé™**
   ```bash
   chmod +x script-name.sh
   ```

2. **ç¼ºå°‘ä¾èµ–**
   ```bash
   # Ubuntu/Debian
   sudo apt-get install jq bc

   # CentOS/RHEL
   sudo yum install jq bc

   # macOS
   brew install jq bc
   ```

3. **JSONè§£æé”™è¯¯**
   - æ£€æŸ¥è¾“å…¥JSONæ ¼å¼
   - éªŒè¯jqå‘½ä»¤å¯ç”¨
   - æŸ¥çœ‹è°ƒè¯•æ—¥å¿—

### è°ƒè¯•æ­¥éª¤

1. ä½¿ç”¨è°ƒè¯•å·¥å…·æ£€æŸ¥è¾“å…¥è¾“å‡º
2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—æ–‡ä»¶
3. é€æ­¥æ‰§è¡Œè„šæœ¬åˆ†æ
4. éªŒè¯é…ç½®æ–‡ä»¶æ ¼å¼

## ğŸ“š ç›¸å…³èµ„æº

- [Claude Code å®˜æ–¹æ–‡æ¡£](https://claude.ai/docs)
- [ç¤ºä¾‹é…ç½®æ–‡ä»¶](./examples/)
- [æœ€ä½³å®è·µæŒ‡å—](./docs/best-practices.md)
- [å®‰å…¨æŒ‡å—](./docs/security.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### æäº¤è§„èŒƒ

1. æ¸…æ™°çš„æäº¤ä¿¡æ¯
2. å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹
3. æ›´æ–°çš„æ–‡æ¡£
4. å®‰å…¨å®¡æŸ¥é€šè¿‡

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-XX)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŒ…å«åŸºç¡€å®¡æ‰¹è„šæœ¬
- æ”¯æŒæ™ºèƒ½ä¸Šä¸‹æ–‡æ„ŸçŸ¥
- æä¾›å®Œæ•´çš„æµ‹è¯•å·¥å…·

---

**æ³¨æ„**: ä½¿ç”¨è¿™äº›è„šæœ¬å‰ï¼Œè¯·ç¡®ä¿ç†è§£å…¶å®‰å…¨å«ä¹‰ï¼Œå¹¶æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚è¿›è¡Œé€‚å½“çš„é…ç½®å’Œæµ‹è¯•ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æ—¶ï¼Œå»ºè®®å…ˆåœ¨å°èŒƒå›´æµ‹è¯•ï¼Œé€æ­¥æ¨å¹¿ã€‚

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ GitHub Issues åé¦ˆï¼

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

- [ ] æ·»åŠ æ›´å¤š Windows ç‰ˆæœ¬è„šæœ¬
- [ ] é›†æˆæœºå™¨å­¦ä¹ æ¨¡å‹
- [ ] æ”¯æŒæ›´å¤šç¼–ç¨‹è¯­è¨€
- [ ] äº‘ç«¯é…ç½®åŒæ­¥
- [ ] å®æ—¶ç›‘æ§é¢æ¿
- [ ] è‡ªåŠ¨åŒ–è§„åˆ™ç”Ÿæˆ

**Happy coding with Claude Code!** ğŸš€